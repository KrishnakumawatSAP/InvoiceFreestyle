sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/MessageBox"],function(e,t,o,a){"use strict";return e.extend("zdashboard.controller.Contacts",{DELETED_PHONE:"XX_DELETED_XX",onInit:function(){var e=new t({busy:true,editable:false,deletedPhone:this.DELETED_PHONE});this.getRouter().getRoute("contacts").attachPatternMatched(this._onRouteMatched,this);var o=this.getView().getBusyIndicatorDelay();this.setModel(e,"contactsView");this.getOwnerComponent().getModel().metadataLoaded().then(function(){e.setProperty("/delay",o)})},onSearch:function(e){this.byId("idContactsTable").rebindTable(true)},onRebindContactsTable:function(e){var t=this.byId("_IDContactSearchField2").getValue();var o=e.getParameter("bindingParams");o.parameters["custom"]={search:t}},onEdit:function(e){this._toggleEdit()},onAdd:function(e){var t=this.getModel().createEntry("/Contacts",{properties:{},refreshAfterChange:false});var o=this.byId("idContactsColumnListItem").clone();o.bindElement(t.getPath());this.byId("idContactsTable").getTable().addItem(o)},onDelete:function(e){var t=e.getParameter("listItem").getBindingContext().getPath();this.getModel().setProperty(t+"/Phone",this.DELETED_PHONE);this.getModel().remove(t,{groupId:"changes"})},onSave:function(e){this.getModel().submitChanges({success:function(e){if(!this.getModel().hasPendingChanges()){o.show("Contatos atualizados com sucesso");this._toggleEdit()}}.bind(this)})},onCancel:function(e){if(!this.getModel().hasPendingChanges()){this.onConfirm(e);return}var t=e.getSource();this.openFragment("zdashboard.view.ConfirmationPopover",{id:"idConfirmationPopover",openBy:t,title:"As modificações serão perdidas. Deseja continuar?"})},onConfirm:function(e){this.getModel().resetChanges();sap.ui.getCore().getMessageManager().removeAllMessages();var t=this.byId("idConfirmationPopover");var o;if(t){t.close();o=t.getOpenedBy()}this.getModel("contactsView").setProperty("/editable",false)},toUpperCase:function(e){e.getSource().setValue(e.getParameter("newValue").toUpperCase())},onShowMessages:function(e){var t=e.getSource();this.openFragment("zdashboard.view.MessagePopover",{id:"idMessagePopover",openBy:t})},_onRouteMatched:function(e){this.getModel("contactsView").setProperty("/editable",false)},_toggleEdit:function(e){var t=!this.getModel("contactsView").getProperty("/editable");this.getModel("contactsView").setProperty("/editable",t)}})});
//# sourceMappingURL=Contacts.controller.js.map