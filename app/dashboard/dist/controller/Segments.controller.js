sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/MessageBox"],function(e,t,s,n){"use strict";return e.extend("zdashboard.controller.Segments",{DELETED_TITLE:"XX_DELETED_XX",onInit:function(){var e=new t({busy:true,editable:false,deletedTitle:this.DELETED_TITLE});this.getRouter().getRoute("segments").attachPatternMatched(this._onRouteMatched,this);var s=this.getView().getBusyIndicatorDelay();this.setModel(e,"segmentsView");this.getOwnerComponent().getModel().metadataLoaded().then(function(){e.setProperty("/delay",s)})},onSearch:function(e){this.byId("idSegmentsTable").rebindTable(true)},onRebindSegmentsTable:function(e){var t=this.byId("_IDSegmentSearchField").getValue();var s=e.getParameter("bindingParams");s.parameters["custom"]={search:t}},onEdit:function(e){this._toggleEdit()},onAdd:function(e){var t=this.getModel().createEntry("/Segments",{properties:{},refreshAfterChange:false});var s=this.byId("idSegmentsColumnListItem").clone();s.bindElement(t.getPath());var n=this.byId("idSegmentsTable").getTable();n.addItem(s)},onDelete:function(e){var t=e.getParameter("listItem").getBindingContext().getPath();this.getModel().setProperty(t+"/Title",this.DELETED_TITLE);this.getModel().remove(t,{groupId:"changes"})},onSave:function(e){if(!this.isValid("segment")){n.error("Verifique os erros e tente novamente");return}this.getModel().submitChanges({success:function(e){if(!this.getModel().hasPendingChanges()){s.show("Segmentos atualizados com sucesso");this._toggleEdit()}}.bind(this)})},onCancel:function(e){if(!this.getModel().hasPendingChanges()){this.onConfirm(e);return}var t=e.getSource();this.openFragment("zdashboard.view.ConfirmationPopover",{id:"idConfirmationPopover",openBy:t,title:"As modificações serão perdidas. Deseja continuar?"})},onConfirm:function(e){this.getModel().resetChanges();sap.ui.getCore().getMessageManager().removeAllMessages();var t=this.byId("idConfirmationPopover");if(t){t.close()}this.getModel("segmentsView").setProperty("/editable",false)},toUpperCase:function(e){e.getSource().setValue(e.getParameter("newValue").toUpperCase())},onShowMessages:function(e){var t=e.getSource();this.openFragment("zdashboard.view.MessagePopover",{id:"idMessagePopover",openBy:t})},_onRouteMatched:function(e){this.getModel("segmentsView").setProperty("/editable",false)},_toggleEdit:function(e){var t=!this.getModel("segmentsView").getProperty("/editable");this.getModel("segmentsView").setProperty("/editable",t)}})});
//# sourceMappingURL=Segments.controller.js.map