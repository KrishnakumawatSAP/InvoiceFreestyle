sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/f/LayoutType","sap/m/MessageBox","sap/m/MessageToast","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/FilterType"],function(e,t,o,i,a,n,s,r){"use strict";return e.extend("zdashboard.controller.Files",{onInit:function(){this.setModel(new t({layout:o.TwoColumnsBeginExpanded}),"filesView");this.oRouter=this.getOwnerComponent().getRouter();this.oRouter.getRoute("files").attachPatternMatched(this._onProductMatched,this)},_onProductMatched:function(e){var t=e.getParameter("arguments").objectId||"0",o=this.byId("InvoiceTable");o.getItems()[o.getBinding("items").aIndices.indexOf(+t)].setSelected(true)},onTabSelect:function(e){var t=e.getParameter("key");var o=this.byId("InvoiceSmartTable");var i=o.getTable().getBinding("items");var a=[];switch(t){case"pdf":a.push(new n("mode",s.EQ,"pdf"));break;case"email":a.push(new n("mode",s.EQ,"email"));break;case"posted":a.push(new n("statusFlag",s.EQ,"S"));break;case"error":a.push(new n("statusFlag",s.EQ,"E"));break;case"all":default:break}if(i){i.filter(a,"Application")}},NavigateToInvoiceDetails:function(e){var t=e.getSource().getBindingContext();var o=t.getProperty("documentId");this.getOwnerComponent().getRouter().navTo("InvoiceDetail",{docId:o})},onOpenCreateDialog:function(e){var t=this.getModel().createEntry("/Invoice",{properties:{},success:function(e){this.onCloseCreateDialog();a.show("Arquivo criado com sucesso")}.bind(this),error:function(e){i.error("Ocorreu um erro ao tentar criar um arquivo")}});this.openFragment("zdashboard.view.FilesCreate",{id:"idFilesCreateDialog",bindingPath:t.getPath()})},onCloseCreateDialog:function(e){var t=this.byId("idFilesCreateDialog");if(t)t.close();this.getModel().resetChanges()},onCreate:function(e){this.getModel().submitChanges()},onDelete:function(e){var t=e.getParameter("listItem").getBindingContextPath();this.getModel().remove(t,{groupId:"deleteFile",success:function(e){var t=this.getRouter().getHashChanger().getHash();var o=this.getRouter().getRouteInfoByHash(t).arguments.objectId;if(e.includes(o))this.getRouter().navTo("files");a.show("Arquivo excluído com sucesso")}.bind(this,t)});var o=e.getParameter("listItem").getDeleteControl();this.openFragment("zdashboard.view.ConfirmationPopover",{id:"idConfirmationPopover",openBy:o,title:"Tem certeza que deseja excluir?"})},onConfirm:function(e){this.getModel().submitChanges({groupId:"deleteFile"});this.byId("idConfirmationPopover").close();return},onCloseDeleteConfirmation:function(e){this.getModel().resetChanges()},onNavBack:function(){history.go(-1)},showDetail:function(e){var t=e.getParameter("listItem").getBindingContext();var o=t.getPath();var a=o.match(/guid'([^']+)'/)[1];function n(){this.getModel().resetChanges();this.getRouter().navTo("fileDetail",{objectId:a})}if(this.getModel().hasPendingChanges()){i.confirm("Os dados não salvos serão perdidos.",{onClose:function(e){if(e==i.Action.OK){n.call(this)}}.bind(this)})}else{n.call(this)}},onSearch:function(e){var t=e.getParameter("query");var o=new n("Title",s.Contains,t);this.byId("idFilesTable").getBinding("items").filter(o,r.Application)}})});
//# sourceMappingURL=Files.controller.js.map